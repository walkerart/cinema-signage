/**  photoshop javascript action for party people pictures*  author: justin heideman*  created: May 03 2007*  last modified: May 03 2007*///reusable variablesvar numLoops = randRange2(23,40);		//how many layers to createvar colorBase = randRange2(1,4);  //establish a color base to use for the layer styles//var theRot = ((Math.random()*15)*getRndNeg())-15;// in case we double clicked the fileapp.bringToFront();//set our units to pixelsapp.preferences.rulerUnits = Units.PIXELS;// get the active Documentvar srcDoc = app.activeDocument;//resize the document to the smallest working size we can deal with//srcDoc.resizeImage(634,424);/*// to the background layer, make a copy of itsrcDoc.activeLayer = srcDoc.layers[srcDoc.layers.length - 1];srcDoc.selection.selectAll();srcDoc.selection.copy();var cutLayer = srcDoc.paste();   //the layer that has the people cut out//select color range// =======================================================var id125 = charIDToTypeID( "ClrR" );    var desc21 = new ActionDescriptor();    var id126 = charIDToTypeID( "Fzns" );    desc21.putInteger( id126, 54 );    //the color sensitivity, 54 seems to be pretty good    var id127 = charIDToTypeID( "Mnm " );        var desc22 = new ActionDescriptor();        var id128 = charIDToTypeID( "Lmnc" );        desc22.putDouble( id128, 90.770000 );        var id129 = charIDToTypeID( "A   " );        desc22.putDouble( id129, 0.830000 );        var id130 = charIDToTypeID( "B   " );        desc22.putDouble( id130, -0.240000 );    var id131 = charIDToTypeID( "LbCl" );    desc21.putObject( id127, id131, desc22 );    var id132 = charIDToTypeID( "Mxm " );        var desc23 = new ActionDescriptor();        var id133 = charIDToTypeID( "Lmnc" );        desc23.putDouble( id133, 90.770000 );        var id134 = charIDToTypeID( "A   " );        desc23.putDouble( id134, 0.830000 );        var id135 = charIDToTypeID( "B   " );        desc23.putDouble( id135, -0.240000 );    var id136 = charIDToTypeID( "LbCl" );    desc21.putObject( id132, id136, desc23 );executeAction( id125, desc21, DialogModes.NO );//clear selectionvar id193 = charIDToTypeID( "Dlt " );executeAction( id193, undefined, DialogModes.NO );*/// =======================================================//loop and make the cubist panes// =======================================================for(i=0;i<numLoops;i++){	var selHeight = randRange2(450,920);	var selWidth = randRange2(450,920);	var selStartX = Math.round( Math.random()*( srcDoc.width -selHeight ) );	var selStartY = Math.round( Math.random()*( srcDoc.height -selWidth ) );	//var x2 = 200;	//var y2 = 300;	srcDoc.selection.select(Array ( 			Array(selStartX, selStartY), 			Array(selStartX+selWidth, selStartY),	 		Array(selStartX+selWidth, selStartY+selHeight), 	 		Array(selStartX, selStartY+selHeight) ), 	 		SelectionType.REPLACE, 0, false);	 			srcDoc.selection.copy();	srcDoc.paste();		//figure out the layer style name	//greenish   1_1-4	//blueish    2_1-4	//redish     3_1-4	//brownish   4_1-4			var lyrStyleName = "NewCubistGlow_"+ colorBase + "_" +eval(Math.round(Math.random()*3)+1);		//apply the inner glow as defined in my styles	srcDoc.activeLayer.applyStyle(lyrStyleName);		var desc = new ActionDescriptor();	var ref = new ActionReference();	ref.putEnumerated( charIDToTypeID('Lyr '), charIDToTypeID('Ordn'), charIDToTypeID('Trgt'));	desc.putReference( charIDToTypeID('null'), ref);	desc.putEnumerated( charIDToTypeID('FTcs'), charIDToTypeID('QCSt'), charIDToTypeID('Qcsa'));    // Scale    var pctXDelta = ((Math.random()*50)*getRndNeg())+100;  //gets a number that should be within around 75 to 125    var pctYDelta = ((Math.random()*50)*getRndNeg())+100;    desc.putUnitDouble( charIDToTypeID('Wdth'), charIDToTypeID('#Prc'), pctXDelta );    desc.putUnitDouble( charIDToTypeID('Hght'), charIDToTypeID('#Prc'), pctYDelta );	// Offset	var angXOff = ((Math.random()*10)*getRndNeg())+10;  	var angYOff = ((Math.random()*10)*getRndNeg())-10;	var desc1 = new ActionDescriptor();	desc1.putUnitDouble( charIDToTypeID('Hrzn'), charIDToTypeID('#Rlt'), angXOff);	desc1.putUnitDouble( charIDToTypeID('Vrtc'), charIDToTypeID('#Rlt'), angYOff);  	// Skew  	var angXSkew = ((Math.random()*10)*getRndNeg())+10;  	var angYSkew = ((Math.random()*10)*getRndNeg())+10;  		var desc2 = new ActionDescriptor();	desc2.putUnitDouble(charIDToTypeID('Hrzn'), charIDToTypeID('#Ang'), angXSkew);	desc2.putUnitDouble(charIDToTypeID('Vrtc'), charIDToTypeID('#Ang'), angYSkew);	//desc.putObject(charIDToTypeID('Ofst'), charIDToTypeID('Ofst'), desc1);	desc.putObject(charIDToTypeID('Skew'), charIDToTypeID('Skew'), desc2);	executeAction( charIDToTypeID('Trnf'), desc, DialogModes.NO);		//rotate the layer a bit		var theRot = ((Math.random()*15)*getRndNeg())-15;	srcDoc.activeLayer.rotate( theRot );		//move the layer around a little bit	var transX = ((Math.random()*10)*getRndNeg())+ (10* getRndNeg()) ;	var transY = ((Math.random()*10)*getRndNeg())+ (10* getRndNeg()) ;	srcDoc.activeLayer.translate( transX , transY  );		if (decide()){		srcDoc.activeLayer.applyAddNoise(2.00,NoiseDistribution.UNIFORM,true)	}	//back to the background layer	srcDoc.activeLayer = srcDoc.layers[srcDoc.layers.length - 1];}//go to background layersrcDoc.activeLayer.duplicate();srcDoc.activeLayer = srcDoc.layers[srcDoc.layers.length - 2];var lyrStyleName = "CubistGlow_"+ colorBase + "_" + eval(Math.round(Math.random()*3)+1);//apply the inner glow as defined in my stylessrcDoc.activeLayer.applyStyle(lyrStyleName);/*var doTextureBg = decide();if (doTextureBg){//Open all the files in one foldervar inputFolder = new Folder("/Users/justin.heideman/Documents/after hours/picasso/prepTexture/")	if (inputFolder != null) {		//Get all the files found in this folder that are (.bmp)		var inputFiles = inputFolder.getFiles("*.tif");				var randIndex = randRange(inputFiles.length-1);		var tempDoc = open( inputFiles[randIndex] );    //THIS LINE HERE (the array inDEX?) IS causing trouble		app.activeDocument = tempDoc;		tempDoc.selection.selectAll();		tempDoc.selection.copy();		app.activeDocument = srcDoc;		var textureLayer = srcDoc.paste();		tempDoc.close();		srcDoc.activeLayer.applyGaussianBlur(1.0);  //apply a gausissian blur on the new layer				//switch to the layer we cut out before		srcDoc.activeLayer = cutLayer;		srcDoc.activeLayer.moveAfter(srcDoc.artLayers[srcDoc.artLayers.length-3]);   // bump it to the bottom of the stack 		}}*///===================================================================//merge and flatten the image//===================================================================/*var layerRef = srcDoc.artLayers.add();layerRef.kind = LayerKind.NORMAL;layerRef.copy(true);//paste into a new merged layersrcDoc.paste();*///this will flatten the image//srcDoc.flatten();//===================================================================/*var filterCount = 0;if (1){	//cutout filter	// =======================================================	var id73 = charIDToTypeID( "GEfc" );    var desc12 = new ActionDescriptor();    var id74 = charIDToTypeID( "GEfk" );    var id75 = charIDToTypeID( "GEft" );    var id76 = charIDToTypeID( "Ct  " );    desc12.putEnumerated( id74, id75, id76 );    var id77 = charIDToTypeID( "NmbL" );    desc12.putInteger( id77, 5 );    var id78 = charIDToTypeID( "EdgS" );    desc12.putInteger( id78, 3 );    var id79 = charIDToTypeID( "EdgF" );    desc12.putInteger( id79, 2 );	executeAction( id73, desc12, DialogModes.NO );	filterCount++;} if (1){	//paint daubs	// =======================================================	var id39 = charIDToTypeID( "GEfc" );    var desc7 = new ActionDescriptor();    var id40 = charIDToTypeID( "GEfk" );    var id41 = charIDToTypeID( "GEft" );    var id42 = charIDToTypeID( "PntD" );    desc7.putEnumerated( id40, id41, id42 );    var id43 = charIDToTypeID( "Sz  " );    desc7.putInteger( id43, 7 );    var id44 = charIDToTypeID( "Shrp" );    desc7.putInteger( id44, 0 );    var id45 = charIDToTypeID( "BrsT" );    var id46 = charIDToTypeID( "BrsT" );    var id47 = charIDToTypeID( "BrsL" );    desc7.putEnumerated( id45, id46, id47 );	executeAction( id39, desc7, DialogModes.NO );	filterCount++;}*///if (doTextureBg){ //blur the image a bit if we applied a background texture	srcDoc.activeLayer.applyGaussianBlur(0.5);//}/*if (decide()){	//texturizer filter	// =======================================================	var id48 = charIDToTypeID( "GEfc" );    var desc8 = new ActionDescriptor();    var id49 = charIDToTypeID( "GEfk" );    var id50 = charIDToTypeID( "GEft" );    var id51 = charIDToTypeID( "Txtz" );    desc8.putEnumerated( id49, id50, id51 );    var id52 = charIDToTypeID( "TxtT" );    var id53 = charIDToTypeID( "TxtT" );    var id54 = charIDToTypeID( "TxBu" );    desc8.putEnumerated( id52, id53, id54 );    var id55 = charIDToTypeID( "Scln" );    desc8.putInteger( id55, 68 );    var id56 = charIDToTypeID( "Rlf " );    desc8.putInteger( id56, 2 );    var id57 = charIDToTypeID( "LghD" );    var id58 = charIDToTypeID( "LghD" );    var id59 = charIDToTypeID( "LDBt" );    desc8.putEnumerated( id57, id58, id59 );    var id60 = charIDToTypeID( "InvT" );    desc8.putBoolean( id60, false );	executeAction( id48, desc8, DialogModes.NO );	filterCount++;}*///function will return either 1 or -1, randomlyfunction getRndNeg(){	var myNum = Math.round(Math.random()*10);	if (myNum > 5){		return -1.0;	} else {		return 1.0;	}}//decides if we should do this or not.. true or false are the returnfunction decide(){	var myNum = Math.round(Math.random()*10);	if (myNum > 5){		return true;	} else {		return false;	}}//generates a random number between 0 and maxRandfunction randRange(maxRand){	return Math.floor(Math.random()*(maxRand+1))}//generates a random number between minRand and maxRandfunction randRange2(minRand,maxRand){	return minRand + ( Math.floor(Math.random()*((maxRand-minRand)+1)));}/* if (decide()){	//supposed to be the liquify filter	// =======================================================	var id4 = charIDToTypeID( "Fltr" );    var desc2 = new ActionDescriptor();    var id5 = charIDToTypeID( "Usng" );    desc2.putString( id5, "Liquify..." );	executeAction( id4, desc2, DialogModes.NO );} */