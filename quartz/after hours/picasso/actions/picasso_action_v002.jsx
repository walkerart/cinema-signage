/**  photoshop javascript action for party people pictures*  author: justin heideman*  created: May 03 2007*  last modified: May 03 2007*/#include "/Developer/xtools/xlib/stdlib.js"  //reusable variablesvar numLoops = 5;		//how many layers to createvar colorBase = eval(Math.round(Math.random()*3)+1);  //establish a color base to use for the layer styles// in case we double clicked the fileapp.bringToFront();//set our units to pixelsapp.preferences.rulerUnits = Units.PIXELS;// get the active Documentvar srcDoc = app.activeDocument;// to the background layersrcDoc.activeLayer = srcDoc.layers[srcDoc.layers.length - 1];for(i=0;i<numLoops;i++){	var selHeight = Math.round(Math.random()*200) +100;	var selWidth = Math.round(Math.random()*200) +100;	var selStartX = Math.round( Math.random()*( srcDoc.width - selWidth ) );	var selStartY = Math.round( Math.random()*( srcDoc.height - selHeight ) );	//var x2 = 200;	//var y2 = 300;	srcDoc.selection.select(Array ( 			Array(selStartX, selStartY), 			Array(selStartX+selWidth, selStartY),	 		Array(selStartX+selWidth, selStartY+selHeight), 	 		Array(selStartX, selStartY+selHeight) ), 	 		SelectionType.REPLACE, 0, false);	 			srcDoc.selection.copy();	srcDoc.paste();		//figure out the layer style name	//greenish   1_1-4	//blueish    2_1-4	//redish     3_1-4	//brownish   4_1-4			var lyrStyleName = "CubistGlow_"+ colorBase + "_" +eval(Math.round(Math.random()*3)+1);		//apply the inner glow as defined in my styles	srcDoc.activeLayer.applyStyle(lyrStyleName);		var desc = new ActionDescriptor();	var ref = new ActionReference();	ref.putEnumerated( charIDToTypeID('Lyr '), charIDToTypeID('Ordn'), charIDToTypeID('Trgt'));	desc.putReference( charIDToTypeID('null'), ref);	desc.putEnumerated( charIDToTypeID('FTcs'), charIDToTypeID('QCSt'), charIDToTypeID('Qcsa'));    // Scale    var pctXDelta = ((Math.random()*50)*getRndNeg())+100;  //gets a number that should be within around 75 to 125    var pctYDelta = ((Math.random()*50)*getRndNeg())+100;    desc.putUnitDouble( charIDToTypeID('Wdth'), charIDToTypeID('#Prc'), pctXDelta );    desc.putUnitDouble( charIDToTypeID('Hght'), charIDToTypeID('#Prc'), pctYDelta );	// Offset	var angXOff = ((Math.random()*10)*getRndNeg())+10;  	var angYOff = ((Math.random()*10)*getRndNeg())-10;	var desc1 = new ActionDescriptor();	desc1.putUnitDouble( charIDToTypeID('Hrzn'), charIDToTypeID('#Rlt'), angXOff);	desc1.putUnitDouble( charIDToTypeID('Vrtc'), charIDToTypeID('#Rlt'), angYOff);  	// Skew  	var angXSkew = ((Math.random()*10)*getRndNeg())+10;  	var angYSkew = ((Math.random()*10)*getRndNeg())+10;  		var desc2 = new ActionDescriptor();	desc2.putUnitDouble(charIDToTypeID('Hrzn'), charIDToTypeID('#Ang'), angXSkew);	desc2.putUnitDouble(charIDToTypeID('Vrtc'), charIDToTypeID('#Ang'), angYSkew);	//desc.putObject(charIDToTypeID('Ofst'), charIDToTypeID('Ofst'), desc1);	desc.putObject(charIDToTypeID('Skew'), charIDToTypeID('Skew'), desc2);	executeAction( charIDToTypeID('Trnf'), desc, DialogModes.NO);		//rotate the layer a bit	srcDoc.activeLayer.rotate( ((Math.random()*5)*getRndNeg())-7 );		//move the layer around a little bit	var transX = ((Math.random()*10)*getRndNeg())+ (10* getRndNeg()) ;	var transY = ((Math.random()*10)*getRndNeg())+ (10* getRndNeg()) ;	srcDoc.activeLayer.translate( transX , transY  );		//back to the background layer	srcDoc.activeLayer = srcDoc.layers[srcDoc.layers.length - 1];}var layerRef = srcDoc.artLayers.add();layerRef.kind = LayerKind.NORMAL;layerRef.copy(true);//paste into a new merged layersrcDoc.paste();//function will return either 1 or -1, randomlyfunction getRndNeg(){	var myNum = Math.round(Math.random()*10);	if (myNum > 5){		return -1.0;	} else {		return 1.0;	}}